# ä¸€é”®éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

1. âœ… æœåŠ¡å™¨å·²åˆ›å»ºï¼ˆ119.45.121.152ï¼‰
2. âœ… åŸŸåè§£æå·²ç”Ÿæ•ˆï¼ˆjubianai.cnï¼‰
3. â³ å®‰è£…ç¯å¢ƒ
4. â³ ä¸Šä¼ ä»£ç 
5. â³ é…ç½®ç¯å¢ƒå˜é‡
6. â³ éƒ¨ç½²åº”ç”¨
7. â³ é…ç½® Nginx
8. â³ é…ç½® SSL

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1ï¼šåœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ç¯å¢ƒ

**è¿æ¥åˆ°æœåŠ¡å™¨ï¼š**
```bash
ssh ubuntu@119.45.121.152
```

**æ‰§è¡Œå®‰è£…è„šæœ¬ï¼š**
```bash
# ä¸Šä¼ å®‰è£…è„šæœ¬åˆ°æœåŠ¡å™¨ï¼ˆåœ¨æœ¬åœ°æ‰§è¡Œï¼‰
scp deploy-to-server.sh ubuntu@119.45.121.152:/tmp/

# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
ssh ubuntu@119.45.121.152
chmod +x /tmp/deploy-to-server.sh
bash /tmp/deploy-to-server.sh
```

**æˆ–è€…æ‰‹åŠ¨æ‰§è¡Œï¼ˆå¦‚æœè„šæœ¬ä¸Šä¼ å¤±è´¥ï¼‰ï¼š**
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£… Node.js
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install 20
nvm use 20
nvm alias default 20

# å®‰è£… PM2
npm install -g pm2
pm2 startup  # æ‰§è¡Œè¾“å‡ºçš„ sudo å‘½ä»¤

# å®‰è£… Nginx
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx

# å®‰è£… Git
sudo apt install git -y

# åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/aigc-agent
sudo chown ubuntu:ubuntu /var/www/aigc-agent
```

---

### æ­¥éª¤2ï¼šä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨

**æ–¹æ³•1ï¼šä½¿ç”¨ PowerShell è„šæœ¬ï¼ˆæ¨èï¼‰**

åœ¨ Windows PowerShell ä¸­ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼š
```powershell
.\upload-to-server.ps1
```

**æ–¹æ³•2ï¼šä½¿ç”¨ SCP æ‰‹åŠ¨ä¸Šä¼ **

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd C:\Users\Administrator\Desktop\AIGC-jubianage-agent

# ä¸Šä¼ ä»£ç ï¼ˆæ’é™¤ node_modulesï¼‰
scp -r --exclude=node_modules --exclude=.git --exclude=dist * ubuntu@119.45.121.152:/var/www/aigc-agent/
```

**æ–¹æ³•3ï¼šä½¿ç”¨ WinSCPï¼ˆå›¾å½¢åŒ–å·¥å…·ï¼‰**

1. ä¸‹è½½ WinSCPï¼šhttps://winscp.net/
2. è¿æ¥åˆ°æœåŠ¡å™¨ï¼ˆ119.45.121.152ï¼Œç”¨æˆ· ubuntuï¼‰
3. ä¸Šä¼ æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹åˆ° `/var/www/aigc-agent/`
4. æ’é™¤ï¼š`node_modules`, `.git`, `dist`

**æ–¹æ³•4ï¼šä½¿ç”¨ Gitï¼ˆå¦‚æœä»£ç åœ¨ GitHubï¼‰**

```bash
ssh ubuntu@119.45.121.152
cd /var/www/aigc-agent
git clone https://github.com/ä½ çš„ç”¨æˆ·å/AIGC-jubianage-agent.git .
```

---

### æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡

**è¿æ¥åˆ°æœåŠ¡å™¨ï¼š**
```bash
ssh ubuntu@119.45.121.152
cd /var/www/aigc-agent/server
```

**åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š**
```bash
cp env.example .env
nano .env
```

**å¿…é¡»é…ç½®çš„é¡¹ï¼š**
```env
PORT=3002
DATABASE_URL=ä½ çš„Supabaseè¿æ¥å­—ç¬¦ä¸²
JWT_SECRET=ä½ çš„JWTå¯†é’¥ï¼ˆä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç”Ÿæˆï¼‰
COS_SECRET_ID=ä½ çš„COS Secret ID
COS_SECRET_KEY=ä½ çš„COS Secret Key
COS_REGION=ap-guangzhou
COS_BUCKET=ä½ çš„bucketåç§°
```

**ç”Ÿæˆ JWT_SECRETï¼š**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**ä¿å­˜æ–‡ä»¶ï¼š** `Ctrl+O` â†’ `Enter` â†’ `Ctrl+X`

---

### æ­¥éª¤4ï¼šéƒ¨ç½²åº”ç”¨

**ä¸Šä¼ éƒ¨ç½²è„šæœ¬ï¼š**
```powershell
# åœ¨æœ¬åœ°æ‰§è¡Œ
scp deploy-app.sh ubuntu@119.45.121.152:/var/www/aigc-agent/
scp setup-nginx.sh ubuntu@119.45.121.152:/var/www/aigc-agent/
```

**åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š**
```bash
ssh ubuntu@119.45.121.152
cd /var/www/aigc-agent
chmod +x deploy-app.sh setup-nginx.sh

# éƒ¨ç½²åº”ç”¨
bash deploy-app.sh

# é…ç½® Nginx
bash setup-nginx.sh
```

---

### æ­¥éª¤5ï¼šé…ç½® SSL è¯ä¹¦

```bash
ssh ubuntu@119.45.121.152

# ä¸Šä¼  SSL é…ç½®è„šæœ¬
# æˆ–åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥æ‰§è¡Œï¼š
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d jubianai.cn -d www.jubianai.cn --email your@email.com --agree-tos --non-interactive
```

---

### æ­¥éª¤6ï¼šé…ç½®é˜²ç«å¢™

```bash
ssh ubuntu@119.45.121.152

sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

---

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥ PM2
pm2 status

# æ£€æŸ¥ Nginx
sudo systemctl status nginx

# æ£€æŸ¥ç«¯å£
sudo netstat -tlnp | grep 3002
```

### 2. æµ‹è¯•è®¿é—®

- è®¿é—®ï¼š`http://jubianai.cn` æˆ– `https://jubianai.cn`
- åº”è¯¥èƒ½çœ‹åˆ°ç™»å½•é¡µé¢

---

## ğŸ”„ æ›´æ–°éƒ¨ç½²

```bash
ssh ubuntu@119.45.121.152
cd /var/www/aigc-agent

# æ‹‰å–æœ€æ–°ä»£ç ï¼ˆå¦‚æœä½¿ç”¨ Gitï¼‰
git pull

# é‡æ–°éƒ¨ç½²
bash deploy-app.sh
```

---

## ğŸ› å¸¸è§é—®é¢˜

### æ— æ³•è¿æ¥æœåŠ¡å™¨
- æ£€æŸ¥å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ 22 ç«¯å£
- ç¡®è®¤ IP åœ°å€æ­£ç¡®

### ä¸Šä¼ ä»£ç å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä½¿ç”¨ WinSCP å›¾å½¢åŒ–å·¥å…·

### ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯
- æ£€æŸ¥ `.env` æ–‡ä»¶æ ¼å¼
- ç¡®è®¤æ‰€æœ‰å¿…éœ€çš„å€¼éƒ½å·²å¡«å†™

### æœåŠ¡æ— æ³•å¯åŠ¨
- æŸ¥çœ‹æ—¥å¿—ï¼š`pm2 logs aigc-backend`
- æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š`cat server/.env`

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š
- `docs/è…¾è®¯äº‘éƒ¨ç½²å®Œæ•´æŒ‡å—.md`
- `éƒ¨ç½²æ­¥éª¤-æŒ‰é¡ºåºæ‰§è¡Œ.md`

