# 服务器上快速修复 - Node.js 未安装

## 🔍 问题
Node.js 没有安装成功，需要手动安装。

---

## 🚀 快速修复

### 在服务器上执行以下命令：

```bash
# 1. 安装 NVM（Node Version Manager）
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# 2. 加载 NVM
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"

# 3. 安装 Node.js 20
nvm install 20
nvm use 20
nvm alias default 20

# 4. 验证安装
node -v
npm -v

# 5. 安装 PM2
npm install -g pm2

# 6. 配置 PM2 开机自启
pm2 startup
# 执行上面输出的 sudo 命令

# 7. 安装 Nginx（如果还没安装）
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx

# 8. 安装 Git（如果还没安装）
sudo apt install git -y

# 9. 将 NVM 添加到 .bashrc（确保每次登录都能使用）
echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.bashrc
echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> ~/.bashrc
echo '[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"' >> ~/.bashrc

# 10. 重新加载配置
source ~/.bashrc

# 11. 再次验证
node -v
npm -v
pm2 -v
nginx -v
```

---

## ✅ 验证安装

执行以下命令，应该都能看到版本号：

```bash
node -v    # 应该显示 v20.x.x
npm -v     # 应该显示 10.x.x
pm2 -v     # 应该显示 PM2 版本
nginx -v   # 应该显示 nginx 版本
```

---

## 📝 如果还是不行

### 方法1：重新加载 shell

```bash
# 退出并重新连接
exit
ssh ubuntu@119.45.121.152

# 然后执行
source ~/.bashrc
node -v
```

### 方法2：检查 NVM 是否安装

```bash
ls -la ~/.nvm
cat ~/.bashrc | grep nvm
```

### 方法3：手动加载 NVM

```bash
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
node -v
```

---

## 🚀 安装完成后

环境安装成功后，继续下一步：

1. 上传代码到服务器
2. 配置环境变量
3. 部署应用

详见：`上传代码-手动命令.md`

